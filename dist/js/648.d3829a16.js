"use strict";(self["webpackChunkageportal"]=self["webpackChunkageportal"]||[]).push([[648],{2648:function(e,t,o){o.r(t),o.d(t,{default:function(){return q}});var i=o(3396),r=o(9242),a=o(7139);const s=e=>((0,i.dD)("data-v-0bb99fee"),e=e(),(0,i.Cn)(),e),l=s((()=>(0,i._)("h1",null," Relatórios disponíveis ",-1))),n={id:"filters"},d={key:0,id:"reports"},u={class:"title"},p=s((()=>(0,i._)("i",{class:"fi fi-rr-document-signed"},null,-1))),c={class:"actions"},m=["onClick"],h=s((()=>(0,i._)("i",{class:"fi fi-rr-eye"},null,-1))),f=s((()=>(0,i._)("span",null,"Visualizar prévia",-1))),_=[h,f],g=["onClick"],w=s((()=>(0,i._)("i",{class:"fi fi-rr-download"},null,-1))),v=s((()=>(0,i._)("span",null,"Baixar relatório",-1))),y=[w,v],k=s((()=>(0,i._)("button",null,[(0,i._)("i",{class:"fi fi-rr-envelope"}),(0,i._)("span",null,"Enviar E-mail")],-1))),E={key:1,id:"modal"},S={id:"card-modal"},b={id:"close-button"},P=s((()=>(0,i._)("h5",{style:{"text-align":"center","font-size":"1.4rem"}},"Selecione o período",-1))),R=s((()=>(0,i._)("input",{type:"submit",value:"Baixar"},null,-1)));function V(e,t,o,s,h,f){return(0,i.wg)(),(0,i.iD)(i.HY,null,[l,(0,i._)("div",n,[(0,i.wy)((0,i._)("input",{type:"text",name:"search",id:"search",autocomplete:"off",placeholder:"Pesquisar relatório...","onUpdate:modelValue":t[0]||(t[0]=e=>h.search=e)},null,512),[[r.nr,h.search]])]),!0===h.status?((0,i.wg)(),(0,i.iD)("div",d,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(f.ReportsFiltered,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"report",key:t,style:(0,a.j5)("animation-delay: "+.1*t+"s")},[(0,i._)("div",u,[p,(0,i._)("span",null,(0,a.zw)(e.nome),1)]),(0,i._)("div",c,[(0,i._)("button",{onClick:t=>f.viewReport(e.id)},_,8,m),(0,i._)("button",{onClick:t=>f.downloadReport(e.isPeriodoHora,e.isPeriodo,e.url,e.nome_arquivo,e.id)},y,8,g),k])],4)))),128))])):(0,i.kq)("",!0),!0===h.modal?((0,i.wg)(),(0,i.iD)("div",E,[(0,i._)("div",S,[(0,i._)("div",b,[(0,i._)("i",{class:"fi fi-rr-cross-small",onClick:t[1]||(t[1]=e=>this.modal=!1)})]),P,(0,i._)("form",{action:"#",onSubmit:t[4]||(t[4]=(0,r.iM)((e=>f.downloadReport(0,0,this.url,this.name,this.reportId)),["prevent"]))},[(0,i.wy)((0,i._)("input",{type:"datetime-local",name:"first_period",id:"first_period","onUpdate:modelValue":t[2]||(t[2]=e=>h.firstPeriod=e),required:""},null,512),[[r.nr,h.firstPeriod]]),(0,i.wy)((0,i._)("input",{type:"datetime-local",name:"last_period",id:"last_period","onUpdate:modelValue":t[3]||(t[3]=e=>h.lastPeriod=e),required:""},null,512),[[r.nr,h.lastPeriod]]),R],32)])])):(0,i.kq)("",!0)],64)}var C=o(680),A=o(8089),I=o(65),M={name:"ReportPage",components:{},data(){return{mode:C.Z.get("mode"),reports:{},url:"",name:"",reportId:0,modal:!1,firstPeriod:"",lastPeriod:"",firstPeriodHour:"",lastPeriodHour:"",loading:!1,status:!1,search:""}},methods:{...(0,I.OI)(["SAVE_MENU","SAVE_SYSTEM"]),modeView:function(e){this.mode=e},getReports:function(){(0,A.m)({method:"GET",url:"agereport/report/reports",headers:{Authorization:"Bearer"+C.Z.get("token")}}).then((e=>{this.reports=e.data,this.status=!0,this.SAVE_SYSTEM({loading:!1})})).catch((e=>{console.log(e)}))},viewReport:function(e){alert(e)},downloadReport:function(e,t,o,i,r){1===t||1===e?(this.name=i,this.reportId=r,this.modal=!0):(this.loading=!0,this.reportId=r,this.SAVE_SYSTEM({loading:!0}),(0,A.m)({method:"GET",url:`agereport/report-download/${this.reportId}`,headers:{Authorization:"Bearer "+C.Z.get("token")},params:{firstPeriod:this.firstPeriod,lastPeriod:this.lastPeriod},responseType:"blob"}).then((e=>{this.loading=!1;let t=new Blob([e.data],{type:"vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o=document.createElement("a");o.href=window.URL.createObjectURL(t),o.download=i,o.click(),this.modal=!1,this.SAVE_SYSTEM({loading:!1})})))}},computed:{...(0,I.Se)(["system"]),ReportsFiltered:function(){let e=[];return e=this.reports.filter((e=>e.nome.toLowerCase().indexOf(this.search.toLowerCase())>-1)),e}},mounted(){this.getReports(),this.SAVE_MENU({system:"agereport",selected:"home"})}},T=o(89);const U=(0,T.Z)(M,[["render",V],["__scopeId","data-v-0bb99fee"]]);var q=U}}]);
//# sourceMappingURL=648.d3829a16.js.map